<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Python æµ·é¾Ÿç¼–è¾‘å™¨ - Python-Online</title>
    <!-- åŠ è½½ static æ¨¡æ¿æ ‡ç­¾ -->
    {% load static %}
    <style>
        body {
            background-color: #f9f5eb;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            margin: 0;
            padding: 0;
        }

        /* å¤´éƒ¨æ ·å¼ */
        header {
            background-color: #3498db;
            color: white;
            padding: 20px;
            text-align: center;
        }

        header h1 {
            margin: 0;
        }

        /* å¯¼èˆªæ æ ·å¼ */
        nav {
            background-color: #2980b9;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
        }

        nav ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
            display: flex;
        }

        nav ul li {
            margin-right: 20px;
        }

        nav ul li a {
            color: white;
            text-decoration: none;
            /* å»æ‰ä¸‹åˆ’çº¿ */
            font-size: 18px;
        }

        nav ul li a:hover {
            text-decoration: underline;
            /* é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºä¸‹åˆ’çº¿ */
        }

        /* ç™»å½•æ³¨å†ŒæŒ‰é’®æ ·å¼ */
        .auth-buttons button {
            background-color: #e74c3c;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 16px;
            margin-left: 10px;
            padding: 8px 15px;
            transition: all 0.3s ease;
        }

        .auth-buttons button:hover {
            background-color: #c0392b;
            transform: scale(1.1);
        }

        /* åŠŸèƒ½æŒ‰é’®åŒºåŸŸæ ·å¼ */
        .function {
            background-color: #3498db;
            padding: 20px;
            text-align: center;
        }

        .function button {
            background-color: #e74c3c;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 18px;
            margin: 0 10px;
            padding: 10px 20px;
            transition: background-color 0.3s ease;
        }

        .function button:hover {
            background-color: #c0392b;
        }

        /* ä¸‹æ‹‰èœå•æ ·å¼ */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
            z-index: 100;
            /* æé«˜å±‚çº§ï¼Œç¡®ä¿åœ¨å…¶ä»–å…ƒç´ ä¹‹ä¸Š */
            border-radius: 5px;
            /* å¢åŠ åœ†è§’ */
            overflow: hidden;
            /* ç¡®ä¿åœ†è§’ç”Ÿæ•ˆ */
        }

        .dropdown-content button {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            width: 100%;
            text-align: left;
            border: none;
            background: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
            /* å¢åŠ è¿‡æ¸¡æ•ˆæœ */
        }

        .dropdown-content button:hover {
            background-color: #f1f1f1;
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }

        /* é¡µé¢ä¸»ä½“æ ·å¼ */
        .page {
            display: flex;
            justify-content: center;
            padding: 20px;
            height: 65vh;
        }

        .CodeMirror {
            font-size: 16px;
            /* å¯æ ¹æ®éœ€æ±‚è°ƒæ•´å­—ä½“å¤§å° */
        }

        .index-form {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 50%;
        }

        .outputd {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-left: 20px;
            padding: 20px;
            width: 50%;
        }

        .canvas-ouput {
            border: 1px solid #ccc;
            margin-bottom: 20px;
            padding: 10px;
        }

        .output {
            border: 1px solid #ccc;
            padding: 10px;
            max-height: 50px;
            /* è®¾ç½®æœ€å¤§é«˜åº¦ï¼Œå¯æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´ */
            overflow-y: auto;
            /* å½“å†…å®¹è¶…å‡ºæœ€å¤§é«˜åº¦æ—¶ï¼Œæ˜¾ç¤ºå‚ç›´æ»šåŠ¨æ¡ */
        }

        /* é¡µè„šæ ·å¼ */
        footer {
            background-color: #34495e;
            color: white;
            text-align: center;
            padding: 10px;
            transition: all 0.3s ease;
            /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
        }

        footer:hover {
            background-color: #2c3e50;
            /* æ‚¬åœæ—¶æ”¹å˜èƒŒæ™¯é¢œè‰² */
            transform: translateY(-5px);
            /* æ‚¬åœæ—¶å‘ä¸Šç§»åŠ¨ 5px */
        }
    </style>
    <!-- ä½¿ç”¨ static æ¨¡æ¿æ ‡ç­¾å¼•å…¥é™æ€æ–‡ä»¶ -->
    <script src="{% static 'js/skulpt.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/skulpt-stdlib.js' %}" type="text/javascript"></script>
    <link href="{% static 'codemirror/lib/codemirror.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'codemirror/theme/monokai.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'codemirror/addon/display/fullscreen.css' %}" rel="stylesheet" type="text/css">
    <script src="{% static 'codemirror/lib/codemirror.js' %}"></script>
    <script src="{% static 'codemirror/mode/python/python.js' %}"></script>
    <!-- æ¨èä½¿ç”¨CDNJSçš„Vueé“¾æ¥ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.14/vue.min.js"></script>

    <!-- View UIï¼ˆåŸiViewï¼‰çš„æœ€æ–°CDN -->
    <link rel="stylesheet" href="https://unpkg.com/view-ui/dist/styles/viewui.css">
    <script src="https://unpkg.com/view-ui/dist/index.js"></script>
</head>

<body>
    <!-- å¤´éƒ¨ -->
    <header>
        <h1>Python æµ·é¾Ÿç¼–è¾‘å™¨</h1>
    </header>
    <!-- å¯¼èˆªæ  -->
    <nav>
        <ul>
            <li><a href="/"><i>ğŸ </i></a></li> <!-- æ·»åŠ è¿”å›é¦–é¡µæŒ‰é’®ï¼Œç”¨å°æˆ¿å­å›¾æ ‡ä»£æ›¿æ–‡å­— -->
            <li><a href="#">ä»£ç ç¼–è¾‘</a></li>
            <li><a href="#">ä»£ç æŸ¥çœ‹</a></li>
            <li><a href="#">ç­¾åˆ°</a></li>
        </ul>
        <div class="auth-buttons">
            <button onclick="saveFile()">ä¿å­˜</button> <!-- æ–°å¢ä¿å­˜æŒ‰é’® -->
            <button onclick="shareCode()">åˆ†äº«</button> <!-- åˆ†äº«æŒ‰é’®ç§»åˆ°è¿™é‡Œ -->
            <button>ç™»å½•</button>
        </div>
    </nav>
    <div id="app">
        <div class="function">
            <div class="dropdown">
                <button>æ–‡ä»¶</button>
                <div class="dropdown-content">
                    <button onclick="newFile()">æ–°å»º</button>
                    <button onclick="openFile()">æ‰“å¼€</button>
                    <button onclick="saveFile()">ä¿å­˜</button>
                    <button onclick="saveAsFile()">å¦å­˜ä¸º</button>
                    <button onclick="importFile()">å¯¼å…¥</button>
                </div>
            </div>
            <button type="primary" icon="md-play" onclick="runit()">è¿è¡Œ</button>
            <button type="error" icon="ios-trash" @click="clear">æ¸…é™¤æ‰€æœ‰</button>
            <button onclick="shareCode()">åˆ†äº«</button>
        </div>
        <div class="page">
            <form class="index-form">
                <textarea id="yourcode" class="index-form">import turtle
turtle.begin_fill()
turtle.fillcolor('red')
for x in range(4):
    turtle.forward(100)
    turtle.right(90)
turtle.end_fill()
turtle.hideturtle()
turtle.done()
print("Hello World")
                </textarea>
            </form>
            <div class="outputd">
                <div id="mycanvas" class="canvas-ouput"></div>
                <div class="output">
                    <pre id="output"> </pre>
                </div>
            </div>
        </div>
    </div>
    <!-- é¡µè„š -->
    <footer>
        &copy; 2024 Python æµ·é¾Ÿç¼–è¾‘å™¨. ç‰ˆæƒæ‰€æœ‰.
    </footer>
    <script>
        new Vue({
            el: '#app',
            data: {

            },
            methods: {

                clear: function (event) {
                    //æ¸…ç©ºä»£ç ç¼–è¾‘åŒº
                    // CodeMirrorEditor.setValue("");

                    var mypre = document.getElementById("output");
                    mypre.innerHTML = "";

                    // æ¸…ç©ºturtleç”»å¸ƒ
                    var canvas = document.getElementById('mycanvas');
                    if (canvas) {
                        canvas.innerHTML = '';
                    }
                },

            }
        })
        //æ–°å¢window.onload äº‹ä»¶,ç”¨æ¥åˆå§‹åŒ–codemirror
        //     window.onload = function () {
        //         //console.log("onload is going")
        //         // æ·»åŠ codemirror æ¨¡å¼
        var myTextarea = document.getElementById('yourcode');
        var CodeMirrorEditor = CodeMirror.fromTextArea(myTextarea, {
            mode: "python",
            lineNumbers: true,
            lineWrapping: true,
            foldGutter: true,
            matchBrackets: true,
            autoCloseBrackets: true,
            styleActiveLine: true,
            indentUnit: 4,

        });
        CodeMirrorEditor.setSize("100%", "100%");

        // }
        function outf(text) {
            var mypre = document.getElementById("output");
            mypre.innerHTML = mypre.innerHTML + text;
        }

        function builtinRead(x) {
            if (Sk.builtinFiles === undefined || Sk.builtinFiles["files"][x] === undefined)
                throw "File not found: '" + x + "'";
            return Sk.builtinFiles["files"][x];
        }

        function runit() {
            var prog = CodeMirrorEditor.getValue();
            var mypre = document.getElementById("output");
            mypre.innerHTML = '';
            Sk.pre = "output";
            Sk.configure({ output: outf, read: builtinRead, __future__: Sk.python3 });
            (Sk.TurtleGraphics || (Sk.TurtleGraphics = {})).target = 'mycanvas';
            var myPromise = Sk.misceval.asyncToPromise(function () {
                return Sk.importMainWithBody("<stdin>", false, prog, true);
            });
            myPromise.then(function (mod) {
                console.log('success');
            },
                function (err) {
                    console.log(err.toString());
                    mypre.innerHTML = err.toString();
                });
        }

        function newFile() {
            CodeMirrorEditor.setValue("");
        }

        function openFile() {
            var input = document.createElement('input');
            input.type = 'file';
            input.accept = '.py';
            input.onchange = function (e) {
                var file = e.target.files[0];
                if (file) {
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        CodeMirrorEditor.setValue(e.target.result);
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        function saveFile() {
            var text = CodeMirrorEditor.getValue();
            var blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
            var a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'code.py';
            a.click();
        }

        function saveAsFile() {
            var text = CodeMirrorEditor.getValue();
            var blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
            var a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            var fileName = prompt('è¯·è¾“å…¥æ–‡ä»¶å', 'code.py');
            if (fileName) {
                a.download = fileName;
                a.click();
            }
        }

        function importFile() {
            openFile();
        }

        function shareCode() {
            var code = CodeMirrorEditor.getValue();
            var shareUrl = 'data:text/plain;charset=utf-8,' + encodeURIComponent(code);
            var a = document.createElement('a');
            a.href = shareUrl;
            a.download = 'shared_code.py';
            a.click();
        }
    </script>
</body>

</html>